<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Поиск жилья на Пхукете</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        h1 {
            font-size: 26px;
            text-align: center;
            color: #0088cc;
            margin-bottom: 20px;
        }
        .step {
            display: none;
        }
        .step.active {
            display: block;
        }
        button {
            background-color: #0088cc;
            color: white;
            border: none;
            padding: 12px;
            margin: 5px 0;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }
        button:hover {
            background-color: #006699;
        }
        select, input[type="date"] {
            width: 100%;
            padding: 12px;
            margin: 5px 0;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>Поиск жилья на Пхукете</h1>

    <!-- Шаг 1: Выбери язык -->
    <div id="step1" class="step active">
        <p>Выбери язык:</p>
        <select id="lang">
            <option value="ru">Русский</option>
            <option value="en">English</option>
        </select>
        <button id="step1-btn">Далее</button>
    </div>

    <!-- Шаг 2: Выбери валюту -->
    <div id="step2" class="step">
        <p>Выбери валюту:</p>
        <select id="currency">
            <option value="THB">THB</option>
            <option value="USD">USD</option>
            <option value="RUB">RUB</option>
        </select>
        <button id="step2-btn">Далее</button>
    </div>

    <!-- Шаг 3: Выбери тип жилья -->
    <div id="step3" class="step">
        <p>Выбери тип жилья:</p>
        <button onclick="selectOption('type', 'apartment', 'step4')">Квартира / Apartment</button>
        <button onclick="selectOption('type', 'villa', 'step4')">Вилла / Villa</button>
        <button onclick="selectOption('type', 'house', 'step4')">Дом / House</button>
    </div>

    <!-- Шаг 4: Укажи даты поездки -->
    <div id="step4" class="step">
        <p>Укажи даты поездки:</p>
        <input type="date" id="start_date" min="2025-03-11">
        <input type="date" id="end_date" min="2025-03-12">
        <button id="step4-btn">Далее</button>
    </div>

    <!-- Шаг 5: Выбери бюджет (THB) -->
    <div id="step5" class="step">
        <p>Выбери бюджет (THB):</p>
        <button onclick="selectOption('budget', '15000', 'step6')">До 15,000</button>
        <button onclick="selectOption('budget', '30000', 'step6')">15,000-30,000</button>
        <button onclick="selectOption('budget', '40000', 'step6')">30,000+</button>
    </div>

    <!-- Шаг 6: Выбери район -->
    <div id="step6" class="step">
        <p>Выбери район:</p>
        <button onclick="selectOption('area', 'patong', 'step7')">Патонг / Patong</button>
        <button onclick="selectOption('area', 'kata', 'step7')">Ката / Kata</button>
        <button onclick="selectOption('area', 'karon', 'step7')">Карон / Karon</button>
    </div>

    <!-- Шаг 7: Сколько спален? -->
    <div id="step7" class="step">
        <p>Сколько спален?</p>
        <button onclick="selectOption('bedrooms', '1', 'step8')">1 спальня / 1 bedroom</button>
        <button onclick="selectOption('bedrooms', '2', 'step8')">2 спальни / 2 bedrooms</button>
        <button onclick="selectOption('bedrooms', '3', 'step8')">3+ спальни / 3+ bedrooms</button>
    </div>

    <!-- Шаг 8: Нужен бассейн? -->
    <div id="step8" class="step">
        <p>Нужен бассейн?</p>
        <button onclick="selectOption('pool', 'yes', 'step9')">Да / Yes</button>
        <button onclick="selectOption('pool', 'no', 'step9')">Нет / No</button>
    </div>

    <!-- Шаг 9: Нужна кухня? -->
    <div id="step9" class="step">
        <p>Нужна кухня?</p>
        <button onclick="selectOption('kitchen', 'yes', 'step10')">Да / Yes</button>
        <button onclick="selectOption('kitchen', 'no', 'step10')">Нет / No</button>
    </div>

    <!-- Шаг 10: Нужен кондиционер? -->
    <div id="step10" class="step">
        <p>Нужен кондиционер?</p>
        <button onclick="selectOption('ac', 'yes', 'step11')">Да / Yes</button>
        <button onclick="selectOption('ac', 'no', 'step11')">Нет / No</button>
    </div>

    <!-- Шаг 11: Как далеко от пляжа? -->
    <div id="step11" class="step">
        <p>Как далеко от пляжа?</p>
        <button onclick="selectOption('beach_dist', '300', 'step12')">До 300 м / Up to 300 m</button>
        <button onclick="selectOption('beach_dist', '800', 'step12')">До 800 м / Up to 800 m</button>
        <button onclick="selectOption('beach_dist', 'any', 'step12')">Любое / Any</button>
    </div>

    <!-- Шаг 12: Минимальный рейтинг? -->
    <div id="step12" class="step">
        <p>Минимальный рейтинг?</p>
        <button onclick="selectOption('rating', '4.0', null, true)">4.0+</button>
        <button onclick="selectOption('rating', '4.5', null, true)">4.5+</button>
        <button onclick="selectOption('rating', '0', null, true)">Любой / Any</button>
    </div>

    <script>
        let searchData = {};

        // Функция выбора опции
        function selectOption(key, value, nextStepId, submit = false) {
            searchData[key] = value;
            if (submit) {
                searchData.lang = document.getElementById("lang").value;
                searchData.currency = document.getElementById("currency").value;
                searchData.start_date = document.getElementById("start_date").value.replace(/-/g, ".");
                searchData.end_date = document.getElementById("end_date").value.replace(/-/g, ".");
                if (!searchData.start_date || !searchData.end_date || new Date(searchData.end_date) <= new Date(searchData.start_date)) {
                    alert("Укажи корректные даты!");
                    return;
                }
                Telegram.WebApp.sendData(JSON.stringify(searchData));
                Telegram.WebApp.close();
            } else if (nextStepId) {
                showStep(nextStepId);
            }
        }

        // Функция показа шага
        function showStep(stepId) {
            const currentStep = document.querySelector(".step.active");
            if (currentStep) {
                currentStep.classList.remove("active");
            }
            const nextStep = document.getElementById(stepId);
            if (nextStep) {
                nextStep.classList.add("active");
            } else {
                alert("Ошибка: шаг не найден!");
            }
        }

        // Инициализация кнопок
        document.getElementById("step1-btn").addEventListener("click", function() {
            showStep("step2");
        });
        document.getElementById("step2-btn").addEventListener("click", function() {
            showStep("step3");
        });
        document.getElementById("step4-btn").addEventListener("click", function() {
            showStep("step5");
        });

        // Инициализация Telegram Web App
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
        Telegram.WebApp.MainButton.hide();
    </script>
</body>
</html>
